# Load the necessary packages
library(Peptides)
library(protr)
library(seqinr)
library(dplyr)
library(stringr)
library(corrplot)
library(randomForest)
library(pROC)
library(tidyr)
library(ggplot2)
library(caret)
# Input AMP Data from a fasta file
AMP_seqs <- read.fasta(file = "../Data/amps.fasta", seqtype = "AA")
# Input non-AMP DATA from a fasta file
non_AMP_seqs <- read.fasta(file = "../Data/non_amps.fasta", seqtype = "AA")
# Store sequences as a list
AMP_seq_chars <- sapply(AMP_seqs, function(x) paste(x, collapse = ""))
non_AMP_seq_chars <- sapply(non_AMP_seqs, function(x) paste(x, collapse = ""))
# Remove duplicate sequences
cat("Number of AMP sequences removed:", length(AMP_seq_chars) - length(unique(AMP_seq_chars)), "\n")
AMP_seq_chars <- unique(AMP_seq_chars)
cat("Number of Non-AMP sequences removed:", length(non_AMP_seq_chars) - length(unique(non_AMP_seq_chars)), "\n")
non_AMP_seq_chars <- unique(non_AMP_seq_chars)
# Create Dataframes for AMP and non-AMP
# AMP dataframe
AMP_df<- data.frame(
AMP_status = 1,
class = c('AMP'),
sequence = AMP_seq_chars,
stringsAsFactors = FALSE
)
# nonAMP dataframe
non_AMP_df<- data.frame(
AMP_status = 0,
class = c('nonAMP'),
sequence = non_AMP_seq_chars,
stringsAsFactors = FALSE
)
# Create Dataframes for AMP and non-AMP
# AMP dataframe
AMP_df<- data.frame(
AMP_status = 1,
class = c('AMP'),
sequence = AMP_seq_chars,
stringsAsFactors = FALSE
)
# nonAMP dataframe
non_AMP_df<- data.frame(
AMP_status = 0,
class = c('nonAMP'),
sequence = non_AMP_seq_chars,
stringsAsFactors = FALSE
)
# Create some features using the Peptides package
feature_df <- feature_df %>%
mutate(
length = lengthpep(sequence),
mw = mw(sequence),
pI = pI(sequence),
hydrophobicity = hydrophobicity(sequence),
charge = charge(sequence),
amphipathicity = hmoment(sequence),
aliphatic_index = aIndex(sequence),
boman_index = boman(sequence),
hmoment = hmoment(sequence)
)
# Remove any non-standard amino acids
AMP_df <- AMP_df[!grepl("[^ACDEFGHIKLMNPQRSTVWY]", AMP_df$sequence), ]
non_AMP_df <- non_AMP_df[!grepl("[^ACDEFGHIKLMNPQRSTVWY]", non_AMP_df$sequence), ]
# Merge the two data frames, ensuring the number of nonAMPs is equal to AMP (balanced)
feature_df = rbind(AMP_df, sample_n(non_AMP_df, size=nrow(AMP_df)))
